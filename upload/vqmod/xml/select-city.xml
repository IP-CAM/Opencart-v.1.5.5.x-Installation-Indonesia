<modification>
	<id>Select City</id>
	<version>1.0.0</version>
	<vqmver>2.3.2</vqmver>
	<author>http://www.opencart-id.com/</author>

	<file name="admin/controller/common/header.php">
		<operation info="Insert City menu in admin">
			<search position="after"><![CDATA[
			$this->data['zone'] = $this->url->link('localisation/zone', 'token=' . $this->session->data['token'], 'SSL');
			]]></search>
			<add><![CDATA[
			$this->data['text_city'] = $this->language->get('text_city');
			$this->data['city'] = $this->url->link('localisation/city', 'token=' . $this->session->data['token'], 'SSL');
			]]></add>
		</operation>
	</file>

	<file name="admin/view/template/common/header.tpl">
		<operation info="Insert City menu in admin">
			<search position="after"><![CDATA[
              <li><a href="<?php echo $zone; ?>"><?php echo $text_zone; ?></a></li>
			]]></search>
			<add><![CDATA[
              <li><a href="<?php echo $city; ?>"><?php echo $text_city; ?></a></li>
			]]></add>
		</operation>
	</file>

	<file name="admin/language/english/common/header.php">
		<operation info="Insert City menu in admin">
			<search position="before"><![CDATA[
?>
			]]></search>
			<add><![CDATA[
$_['text_city']                        = 'Cities';
			]]></add>
		</operation>
	</file>

	<file path="catalog/controller/" name="account/address.php,account/register.php,affiliate/edit.php,affiliate/register.php">
		<operation info="Get cities data">
			<search position="before"><![CDATA[
    	if (isset($this->request->post['city'])) {
			]]></search>
			<add><![CDATA[
		$this->load->model('localisation/city');

		$this->data['cities'] = $this->model_localisation_city->getCities();
			]]></add>
		</operation>
	</file>

	<file name="catalog/controller/checkout/guest.php">
		<operation info="Get payment cities data">
			<search position="before"><![CDATA[
		if (isset($this->session->data['guest']['payment']['city'])) {
			]]></search>
			<add><![CDATA[
		$this->load->model('localisation/city');

		$this->data['cities'] = $this->model_localisation_city->getCities();
			]]></add>
		</operation>
	</file>

	<file name="catalog/controller/checkout/guest_shipping.php">
		<operation info="Get shipping cities data">
			<search position="before"><![CDATA[
		if (isset($this->session->data['guest']['shipping']['city'])) {
			]]></search>
			<add><![CDATA[
		$this->load->model('localisation/city');

		$this->data['cities'] = $this->model_localisation_city->getCities();
			]]></add>
		</operation>
	</file>

	<file path="catalog/controller/checkout/" name="payment_address.php,register.php,shipping_address.php">
		<operation info="Get payment cities data">
			<search position="before" index="1"><![CDATA[
		$this->load->model('localisation/country');
			]]></search>
			<add><![CDATA[
		$this->load->model('localisation/city');

		$this->data['cities'] = $this->model_localisation_city->getCities();
			]]></add>
		</operation>
	</file>

	<file path="catalog/view/theme/default/template/" name="account/address_form.tpl,account/register.tpl,affiliate/edit.tpl,affiliate/register.tpl">
		<operation info="Remove city field">
			<search position="replace" offset="8"><![CDATA[
          <td><input type="text" name="address_2" value="<?php echo $address_2; ?>" /></td>
			]]></search>
			<add><![CDATA[
          <td><input type="text" name="address_2" value="<?php echo $address_2; ?>" /></td>
        </tr>
			]]></add>
		</operation>

		<operation info="Change city text field to select and place it after zone">
			<search position="after" offset="2"><![CDATA[
            <span class="error"><?php echo $error_zone; ?></span>
			]]></search>
			<add><![CDATA[
        <tr>
          <td><span class="required">*</span> <?php echo $entry_city; ?></td>
          <td><select name="city">
              <option value=""><?php echo $text_select; ?></option>
              <?php foreach ($cities as $city_data) { ?>
              <?php if ($city_data['city_id'] == $city) { ?>
              <option value="<?php echo $city_data['name']; ?>" selected="selected"><?php echo $city_data['name']; ?></option>
              <?php } else { ?>
              <option value="<?php echo $city_data['name']; ?>"><?php echo $city_data['name']; ?></option>
              <?php } ?>
              <?php } ?>
            </select>
            <?php if ($error_city) { ?>
            <span class="error"><?php echo $error_city; ?></span>
            <?php } ?>
          </td>
        </tr>
			]]></add>
		</operation>
	</file>

	<file name="catalog/view/theme/default/template/checkout/guest.tpl">
		<operation info="Remove city field">
			<search position="replace" offset="4"><![CDATA[
  <input type="text" name="address_2" value="<?php echo $address_2; ?>" class="large-field" />
			]]></search>
			<add><![CDATA[
  <input type="text" name="address_2" value="<?php echo $address_2; ?>" class="large-field" />
			]]></add>
		</operation>

		<operation info="Change city text field to select and place it after zone">
			<search position="after" offset="1"><![CDATA[
  <select name="zone_id" class="large-field">
			]]></search>
			<add><![CDATA[
  <br />
  <br />
  <select name="city" class="large-field">
    <option value=""><?php echo $text_select; ?></option>
    <?php foreach ($cities as $city_data) { ?>
    <?php if ($city_data['city_id'] == $city) { ?>
    <option value="<?php echo $city_data['name']; ?>" selected="selected"><?php echo $city_data['name']; ?></option>
    <?php } else { ?>
    <option value="<?php echo $city_data['name']; ?>"><?php echo $city_data['name']; ?></option>
    <?php } ?>
    <?php } ?>
  </select>
			]]></add>
		</operation>
	</file>

	<file name="catalog/view/theme/default/template/checkout/guest_shipping.tpl">
		<operation info="Remove city field">
			<search position="replace" offset="5"><![CDATA[
    <td><input type="text" name="address_2" value="<?php echo $address_2; ?>" class="large-field" /></td>
			]]></search>
			<add><![CDATA[
    <td><input type="text" name="address_2" value="<?php echo $address_2; ?>" class="large-field" /></td>
  </tr>
			]]></add>
		</operation>

		<operation info="Change city text field to select and place it after zone">
			<search position="after" offset="2"><![CDATA[
    <td><select name="zone_id" class="large-field">
			]]></search>
			<add><![CDATA[
  <tr>
    <td><span class="required">*</span> <?php echo $entry_city; ?></td>
    <td><select name="city" class="large-field">
        <option value=""><?php echo $text_select; ?></option>
        <?php foreach ($cities as $city_data) { ?>
        <?php if ($city_data['city_id'] == $city) { ?>
        <option value="<?php echo $city_data['name']; ?>" selected="selected"><?php echo $city_data['name']; ?></option>
        <?php } else { ?>
        <option value="<?php echo $city_data['name']; ?>"><?php echo $city_data['name']; ?></option>
        <?php } ?>
        <?php } ?>
      </select>
    </td>
  </tr>
			]]></add>
		</operation>
	</file>

	<file path="catalog/view/theme/default/template/checkout/" name="payment_address.tpl,shipping_address.tpl">
		<operation info="Remove city field">
			<search position="replace" offset="5"><![CDATA[
      <td><input type="text" name="address_2" value="" class="large-field" /></td>
			]]></search>
			<add><![CDATA[
      <td><input type="text" name="address_2" value="" class="large-field" /></td>
    </tr>
			]]></add>
		</operation>

		<operation info="Change city text field to select and place it after zone">
			<search position="after" offset="2"><![CDATA[
      <td><select name="zone_id" class="large-field">
			]]></search>
			<add><![CDATA[
    <tr>
      <td><span class="required">*</span> <?php echo $entry_city; ?></td>
      <td><select name="city" class="large-field">
          <option value=""><?php echo $text_select; ?></option>
          <?php foreach ($cities as $city_data) { ?>
          <?php if ($city_data['city_id'] == $city) { ?>
          <option value="<?php echo $city_data['name']; ?>" selected="selected"><?php echo $city_data['name']; ?></option>
          <?php } else { ?>
          <option value="<?php echo $city_data['name']; ?>"><?php echo $city_data['name']; ?></option>
          <?php } ?>
          <?php } ?>
        </select>
      </td>
    </tr>
			]]></add>
		</operation>
	</file>

	<file name="catalog/view/theme/default/template/checkout/register.tpl">
		<operation info="Remove city field">
			<search position="replace" offset="4"><![CDATA[
<input type="text" name="address_2" value="" class="large-field" />
			]]></search>
			<add><![CDATA[
<input type="text" name="address_2" value="" class="large-field" />
			]]></add>
		</operation>

		<operation info="Change city text field to select and place it after zone">
			<search position="after" offset="1"><![CDATA[
<select name="zone_id" class="large-field">
			]]></search>
			<add><![CDATA[
<br />
<br />
<select name="city" class="large-field">
  <option value=""><?php echo $text_select; ?></option>
  <?php foreach ($cities as $city_data) { ?>
  <?php if ($city_data['city_id'] == $city) { ?>
  <option value="<?php echo $city_data['name']; ?>" selected="selected"><?php echo $city_data['name']; ?></option>
  <?php } else { ?>
  <option value="<?php echo $city_data['name']; ?>"><?php echo $city_data['name']; ?></option>
  <?php } ?>
  <?php } ?>
</select>
			]]></add>
		</operation>
	</file>
</modification>